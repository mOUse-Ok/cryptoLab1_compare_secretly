# 基于 Goldwasser-Micali 的 16 位秘密比较协议

## 项目概述

本项目实现了一个基于 Goldwasser-Micali (GM) 概率加密体制的 16 位秘密比较协议。该协议允许两个参与者 A 和 B 在不泄露各自持有的 16 位非负整数（0-65535）具体值的情况下，由 B 确定 A 的数是否小于 B 的数。

**注意**：为了方便验证协议正确与否，本项目在实现时选用 python 语言且未使用 GMP 库，有关大素数生成等操作会严重影响实际部署时的协议安全性，本项目仅作南开大学密码科学与技术专业 2025 现代密码学课程实验作业提交及展示所用。

## 技术原理

### Goldwasser-Micali 密码体制

Goldwasser-Micali 是一种概率加密方案，基于二次剩余问题 (QRP) 的困难性假设。其主要特点包括：



* **完美隐藏性**：加密后的密文与随机数在计算上不可区分

* **概率性**：同一明文会产生不同的密文

* **安全性**：基于大整数分解和二次剩余问题的困难性

### 秘密比较协议

协议采用逐位比较的方式，通过 16 轮消息交换完成比较。每轮处理一个二进制位，从最低位到最高位。关键技术包括：



* 位运算掩码技术

* 随机数隐藏

* 逐轮迭代比较

## 项目结构



```
secret\_comparison\_16bit/

├── goldwasser\_micali.py                # GM密码体制实现

├── secure\_comparison\_16bit.py          # 16位秘密比较协议实现

├── secure\_comparison\_16bit\_demo.py     # 简化版演示程序

└── README.md                           # 项目文档
```

## 安装与使用

### 环境要求



* Python 3.13

* 依赖库：无（使用 Python 标准库）

### 快速开始

#### 使用简化版演示程序（推荐）



```
python secure\_comparison\_16bit\_demo.py
```

程序会交互式地要求输入两个秘密值，并展示完整的消息交换过程：



```
请输入参与者A的秘密值a: 123

请输入参与者B的秘密值b: 456

参与者A的秘密输入: a = 123 (0x007B)

参与者B的秘密输入: b = 456 (0x01C8)

实际关系: 123 < 456 = True

正在执行秘密比较协议...

\--------------------------------------------------------------------------------

完整的消息交换过程:

\--------------------------------------------------------------------------------

消息 #1: 参与者B → 参与者A

内容描述: B -> A : 公钥pk, E(b0)

消息内容: {'pk': (123456789, 35791357), 'E\_b0': 1234567}

\--------------------------------------------------------------------------------

消息 #2: 参与者A → 参与者B

内容描述: A -> B : M2 = E(t0) \* E(r0) = E(t0 ⊕ r0)

消息内容: {'M2': 7654321}

\--------------------------------------------------------------------------------

...
```

#### 直接使用 API



```
from secure\_comparison\_16bit import SecureComparisonProtocol\_16bit

\# 参与者A和B分别持有16位整数

a = 12345  # A的秘密输入

b = 54321  # B的秘密输入

\# 运行协议

t, A\_messages, B\_messages = SecureComparisonProtocol\_16bit.run\_protocol(a, b)

print(f"协议结果: t = {t}")

print(f"含义: {a} < {b} = {t == 1}")

print(f"A发送的消息数: {len(A\_messages)}")

print(f"B发送的消息数: {len(B\_messages)}")

print(f"总消息数: {len(A\_messages) + len(B\_messages)}")
```

## 详细说明

### 协议执行流程



1. **初始化阶段**：

* B 生成 GM 密钥对

* B 发送公钥和加密的 b 的最低位给 A

1. **主循环（16 轮）**：

* 每轮处理一个二进制位（从最低位到最高位）

* B 解密 A 的消息，计算中间结果并加密

* A 根据自己的位值和之前的随机数构造新消息

1. **最终阶段**：

* A 发送最后一位的加密结果

* B 解密得到最终比较结果 t

### 消息交换过程

协议总共交换 32 条消息：



* B 发送 16 条消息

* A 发送 16 条消息

每条消息都包含序号、发送者、接收者、内容描述和具体内容。

### 安全性保证



1. **信息论安全性**：

* 基于二次剩余问题的困难性假设

* GM 加密提供完美隐藏性

1. **隐私保护**：

* A 的输入 a 对 B 完全保密

* B 的输入 b 对 A 完全保密

* 只泄露 a < b 的关系，不泄露具体数值

1. **诚实好奇模型**：

* 假设双方诚实地执行协议

* 即使双方好奇地分析消息，也无法推断对方的输入

## 测试用例

项目包含 8 个测试用例，覆盖各种情况：



1. `a = 10, b = 20` → t = 1 (True)

2. `a = 20, b = 10` → t = 0 (False)

3. `a = 0, b = 0` → t = 0 (False)

4. `a = 0, b = 1` → t = 1 (True)

5. `a = 65535, b = 0` → t = 0 (False)

6. `a = 12345, b = 54321` → t = 1 (True)

7. `a = 32767, b = 32768` → t = 1 (True)

8. `a = 65535, b = 65535` → t = 0 (False)

## API 参考

### SecureComparisonProtocol\_16bit.run\_protocol(a, b, key\_size=32, verbose=False)

运行 16 位秘密比较协议

**参数**：



* `a` (int): 参与者 A 持有的 16 位整数 (0-65535)

* `b` (int): 参与者 B 持有的 16 位整数 (0-65535)

* `key_size` (int): GM 密码体制的密钥大小（比特数）

* `verbose` (bool): 是否输出详细执行过程

**返回**：



* `t` (int): 比较结果 (1 表示 a < b，0 表示 a >= b)

* `A_messages` (list): A 发送的所有消息记录

* `B_messages` (list): B 发送的所有消息记录

## 性能分析



* **消息复杂度**：每轮比较需要 32 条消息（A 发送 16 条，B 发送 16 条）

* **计算复杂度**：主要是模运算和指数运算，与密钥大小相关

* **安全性**：密钥大小越大，安全性越高，但计算成本也越高

## 应用场景



1. **隐私保护的计算**：在不泄露原始数据的情况下进行比较运算

2. **安全多方计算**：作为复杂安全计算协议的基础组件

3. **电子商务**：价格比较、竞拍系统等

4. **密码学协议**：零知识证明、不经意传输等

## 注意事项



1. **输入范围**：确保输入是 16 位无符号整数（0-65535）

2. **密钥大小**：生产环境建议使用更大的密钥大小（如 64 位或 128 位）

3. **性能考虑**：密钥大小增加会提高安全性，但也会增加计算时间

4. **随机性**：协议依赖于高质量的随机数生成

## 扩展建议



1. **支持更长的整数**：扩展到 32 位、64 位等

2. **批量比较**：同时比较多个整数

3. **其他比较关系**：扩展到 a > b、a == b 等

4. **优化性能**：使用更高效的算法和数据结构

## 许可证

本项目采用 MIT 许可证，详情请参见 LICENSE 文件。

## 联系方式

如有问题或建议，请通过以下方式联系：



* 项目主页：[https://github.com/mOUse-Ok/cryptoLab1\_compare\_secretly](https://github.com/mOUse-Ok/cryptoLab1_compare_secretly)

* 邮箱：2312114@mail.nankai.edu.cn
