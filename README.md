# 基于Goldwasser-Micali的16位秘密比较协议

## 项目概述

本项目实现了一个基于Goldwasser-Micali(GM)概率加密体制的16位秘密比较协议。该协议允许两个参与者A和B在不泄露各自持有的16位非负整数（0-65535）具体值的情况下，由B确定A的数是否小于B的数。

## 技术原理

### Goldwasser-Micali密码体制

Goldwasser-Micali是一种概率加密方案，基于二次剩余问题(QRP)的困难性假设。其主要特点包括：

- **完美隐藏性**：加密后的密文与随机数在计算上不可区分
- **概率性**：同一明文会产生不同的密文
- **安全性**：基于大整数分解和二次剩余问题的困难性

### 秘密比较协议

协议采用逐位比较的方式，通过16轮消息交换完成比较。每轮处理一个二进制位，从最低位到最高位。关键技术包括：

- 位运算掩码技术
- 随机数隐藏
- 逐轮迭代比较

## 项目结构

```
secret_comparison_16bit/
├── goldwasser_micali.py        # GM密码体制实现
├── secure_comparison_16bit.py  # 16位秘密比较协议实现
├── protocol_demo.py            # 协议演示程序
└── README.md                   # 项目文档

```

## 安装与使用

### 环境要求

- Python 3.13
- 依赖库：无（使用Python标准库）

### 快速开始

```python
from secure_comparison_16bit import SecureComparisonProtocol_16bit

# 参与者A和B分别持有16位整数
a = 12345  # A的秘密输入
b = 54321  # B的秘密输入

# 运行协议
t, A_messages, B_messages = SecureComparisonProtocol_16bit.run_protocol(a, b)

print(f"协议结果: t = {t}")
print(f"含义: {a} < {b} = {t == 1}")
print(f"A发送的消息数: {len(A_messages)}")
print(f"B发送的消息数: {len(B_messages)}")
```

## 详细说明

### 协议执行流程

1. **初始化阶段**：
   - B生成GM密钥对
   - B发送公钥和加密的b的最低位给A

2. **主循环（16轮）**：
   - 每轮处理一个二进制位（从最低位到最高位）
   - B解密A的消息，计算中间结果并加密
   - A根据自己的位值和之前的随机数构造新消息

3. **最终阶段**：
   - A发送最后一位的加密结果
   - B解密得到最终比较结果t

### 安全性保证

1. **信息论安全性**：
   - 基于二次剩余问题的困难性假设
   - GM加密提供完美隐藏性

2. **隐私保护**：
   - A的输入a对B完全保密
   - B的输入b对A完全保密
   - 只泄露a < b的关系，不泄露具体数值

3. **诚实好奇模型**：
   - 假设双方诚实地执行协议
   - 即使双方好奇地分析消息，也无法推断对方的输入

## 测试用例

项目包含8个测试用例，覆盖各种情况：

1. `a = 10, b = 20` → t = 1 (True)
2. `a = 20, b = 10` → t = 0 (False)
3. `a = 0, b = 0` → t = 0 (False)
4. `a = 0, b = 1` → t = 1 (True)
5. `a = 65535, b = 0` → t = 0 (False)
6. `a = 12345, b = 54321` → t = 1 (True)
7. `a = 32767, b = 32768` → t = 1 (True)
8. `a = 65535, b = 65535` → t = 0 (False)

## API参考

### SecureComparisonProtocol_16bit.run_protocol(a, b, key_size=32, verbose=False)

运行16位秘密比较协议

**参数**：
- `a` (int): 参与者A持有的16位整数 (0-65535)
- `b` (int): 参与者B持有的16位整数 (0-65535)
- `key_size` (int): GM密码体制的密钥大小（比特数）
- `verbose` (bool): 是否输出详细执行过程

**返回**：
- `t` (int): 比较结果 (1表示a < b，0表示a >= b)
- `A_messages` (list): A发送的所有消息记录
- `B_messages` (list): B发送的所有消息记录

## 性能分析

- **消息复杂度**：每轮比较需要32条消息（A发送16条，B发送16条）
- **计算复杂度**：主要是模运算和指数运算，与密钥大小相关
- **安全性**：密钥大小越大，安全性越高，但计算成本也越高

## 应用场景

1. **隐私保护的计算**：在不泄露原始数据的情况下进行比较运算
2. **安全多方计算**：作为复杂安全计算协议的基础组件
3. **电子商务**：价格比较、竞拍系统等
4. **密码学协议**：零知识证明、不经意传输等

## 注意事项

1. **输入范围**：确保输入是16位无符号整数（0-65535）
2. **密钥大小**：生产环境建议使用更大的密钥大小（如64位或128位）
3. **性能考虑**：密钥大小增加会提高安全性，但也会增加计算时间
4. **随机性**：协议依赖于高质量的随机数生成

## 扩展建议

1. **支持更长的整数**：扩展到32位、64位等
2. **批量比较**：同时比较多个整数
3. **其他比较关系**：扩展到a > b、a == b等
4. **优化性能**：使用更高效的算法和数据结构

## 许可证

本项目采用MIT许可证，详情请参见LICENSE文件。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目主页：https://github.com/mOUse-Ok/cryptoLab1_compare_secretly
- 邮箱：2312114@mail.nankai.edu.cn 
